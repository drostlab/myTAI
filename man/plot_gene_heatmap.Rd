% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_gene_heatmap.R
\name{plot_gene_heatmap}
\alias{plot_gene_heatmap}
\title{Plot Gene Expression Heatmap}
\usage{
plot_gene_heatmap(
  phyex_set,
  genes = NULL,
  top_p = 0.2,
  std = TRUE,
  reps = FALSE,
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  show_gene_age = TRUE,
  show_gene_ids = FALSE,
  ...
)
}
\arguments{
\item{phyex_set}{A PhyloExpressionSet object}

\item{genes}{Character vector of specific genes to plot. If NULL, uses top dynamic genes}

\item{top_p}{Proportion of most dynamic genes to include (default: 0.2)}

\item{std}{Logical indicating whether to use standardized expression values (default: TRUE)}

\item{reps}{Logical indicating whether to show individual replicates or collapsed conditions (default: FALSE)}

\item{cluster_rows}{Logical indicating whether to cluster genes/rows (default: FALSE)}

\item{cluster_cols}{Logical indicating whether to cluster conditions/columns (default: FALSE)}

\item{show_gene_age}{Logical indicating whether to show gene age as row annotation (default: TRUE)}

\item{show_gene_ids}{Logical indicating whether to show gene names (default: FALSE)}

\item{...}{Additional arguments passed to pheatmap::pheatmap}
}
\value{
A ggplot object (converted from pheatmap) showing the gene expression heatmap
}
\description{
Create a heatmap showing gene expression patterns across conditions
with optional dendrograms and gene age annotation.
}
\details{
This function creates a comprehensive heatmap visualization of gene expression patterns.
By default, genes are ordered by their expression angle (developmental trajectory).
The function supports clustering of both genes and conditions, and can optionally
display gene age (phylostratum) as a colored annotation bar.

The gene age annotation uses the PS_colours function to create a consistent
color scheme across different myTAI visualizations.
}
\examples{
# Basic heatmap with gene age annotation
# p1 <- plot_gene_heatmap(phyex_set, show_gene_age = TRUE)

# Clustered heatmap with standardized values
# p2 <- plot_gene_heatmap(phyex_set, std = TRUE, cluster_rows = TRUE, cluster_cols = TRUE)

# Heatmap of specific genes with replicates
# p3 <- plot_gene_heatmap(phyex_set, genes = c("gene1", "gene2"), reps = TRUE)

}
