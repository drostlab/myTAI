<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Obtaining taxonomy information • myTAI</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Obtaining taxonomy information">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">myTAI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/myTAI.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/phylo-expression-object.html">Bring your datasets into myTAI</a></li>
    <li><a class="dropdown-item" href="../articles/tai-stats.html">Statistical testing with myTAI</a></li>
    <li><a class="dropdown-item" href="../articles/tai-transform.html">Transforming dataset for myTAI</a></li>
    <li><a class="dropdown-item" href="../articles/tai-breaker.html">Break TAI patterns using gaTAI</a></li>
    <li><a class="dropdown-item" href="../articles/tai-gallery.html">Beautiful plots made via myTAI</a></li>
    <li><a class="dropdown-item" href="../articles/index.html">... and view more!</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/drostlab/myTAI/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Obtaining taxonomy information</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/drostlab/myTAI/blob/HEAD/vignettes/taxonomy.Rmd" class="external-link"><code>vignettes/taxonomy.Rmd</code></a></small>
      <div class="d-none name"><code>taxonomy.Rmd</code></div>
    </div>

    
    
<p>The <code>taxonomy()</code> function (formerly) implemented in
<code>myTAI</code> relies on the powerful package <a href="https://github.com/ropensci/taxize" class="external-link">taxize</a>. More specifically,
the taxonomic information retrieval has been customized for the
<code>myTAI</code> standard and for organism specific information
retrieval.</p>
<div class="important">
<p>While the previous <code>taxonomy()</code> function has been
<strong>deprecated</strong> since <code>taxize</code> was pulled from
CRAN, users can nevertheless follow the taxonomy pipeline by installing
the <code>taxize</code> package and <strong>copy</strong> the old
taxonomy function.</p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install taxize from CRAN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"taxize"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># if taxize is not available again</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ropensci/taxize"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Copy</strong> the taxonomy function:</p>
<details><summary><strong>open for the taxonomy function</strong>
</summary><p>Click on the copy icon to copy the function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Retrieving Taxonomic Information of a Query Organism</span></span>
<span><span class="co">#' @description This function takes the scientific name of a query organism</span></span>
<span><span class="co">#' and returns selected output formats of taxonomic information for the corresponding organism.</span></span>
<span><span class="co">#' @param organism a character string specifying the scientific name of a query organism.</span></span>
<span><span class="co">#' @param db a character string specifying the database to query, e.g. \code{db} = \code{"itis"} or \code{"ncbi"}.</span></span>
<span><span class="co">#' @param output a character string specifying the taxonomic information that shall be returned. </span></span>
<span><span class="co">#' Implemented are: \code{output} = \code{"classification"}, \code{"taxid"}, or \code{"children"}.</span></span>
<span><span class="co">#' @details This function is based on the powerful package \pkg{taxize} and implements</span></span>
<span><span class="co">#' the customized retrieval of taxonomic information for a query organism. </span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' The following data bases can be selected to retrieve taxonomic information:</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' \itemize{</span></span>
<span><span class="co">#' \item \code{db = "itis"} : Integrated Taxonomic Information Service</span></span>
<span><span class="co">#' \item \code{db = "ncbi"} : National Center for Biotechnology Information</span></span>
<span><span class="co">#' }</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @author Hajk-Georg Drost</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' \dontrun{</span></span>
<span><span class="co">#' # retrieving the taxonomic hierarchy of "Arabidopsis thaliana"</span></span>
<span><span class="co">#' # from NCBI Taxonomy</span></span>
<span><span class="co">#' taxonomy("Arabidopsis thaliana",db = "ncbi")</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' # the same can be applied to database : "itis"</span></span>
<span><span class="co">#'  taxonomy("Arabidopsis thaliana",db = "itis")</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' # retrieving the taxonomic hierarchy of "Arabidopsis"</span></span>
<span><span class="co">#'  taxonomy("Arabidopsis",db = "ncbi") # analogous : db = "ncbi" or "itis"</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' # or just "Arabidopsis"</span></span>
<span><span class="co">#'  taxonomy("Arabidopsis",db = "ncbi")</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' # retrieving the taxonomy id of the query organism and in the correspondning database</span></span>
<span><span class="co">#' # taxonomy("Arabidopsis thaliana",db = "ncbi", output = "taxid")</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' # the same can be applied to databases : "ncbi" and "itis"</span></span>
<span><span class="co">#'  taxonomy("Arabidopsis thaliana",db = "ncbi", output = "taxid")</span></span>
<span><span class="co">#'  taxonomy("Arabidopsis thaliana",db = "itis", output = "taxid")</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' # retrieve children taxa of the query organism stored in the correspondning database</span></span>
<span><span class="co">#'  taxonomy("Arabidopsis",db = "ncbi", output = "children")</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' # the same can be applied to databases : "ncbi" and "itis"</span></span>
<span><span class="co">#'  taxonomy("Arabidopsis thaliana",db = "ncbi", output = "children")</span></span>
<span><span class="co">#'  taxonomy("Arabidopsis thaliana",db = "itis", output = "children")</span></span>
<span><span class="co">#'  </span></span>
<span><span class="co">#' }</span></span>
<span><span class="co">#' @references</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' Scott Chamberlain and Eduard Szocs (2013). taxize - taxonomic search and retrieval in R. F1000Research,</span></span>
<span><span class="co">#' 2:191. URL: http://f1000research.com/articles/2-191/v2.</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' Scott Chamberlain, Eduard Szocs, Carl Boettiger, Karthik Ram, Ignasi Bartomeus, and John Baumgartner</span></span>
<span><span class="co">#' (2014) taxize: Taxonomic information from around the web. R package version 0.3.0.</span></span>
<span><span class="co">#' https://github.com/ropensci/taxize</span></span>
<span><span class="co">#' @export</span></span>
<span></span>
<span><span class="va">taxonomy</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">organism</span>, <span class="va">db</span> <span class="op">=</span> <span class="st">"ncbi"</span>, <span class="va">output</span> <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span><span class="op">{</span></span>
<span>        </span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">is.element</a></span><span class="op">(</span><span class="va">output</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classification"</span>,<span class="st">"taxid"</span>,<span class="st">"children"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span> <span class="op">(</span><span class="st">"The output '"</span>,<span class="va">output</span>,<span class="st">"' is not supported by this function."</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">is.element</a></span><span class="op">(</span><span class="va">db</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ncbi"</span>,<span class="st">"itis"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span> <span class="op">(</span><span class="st">"Database '"</span>,<span class="va">db</span>,<span class="st">"' is not supported by this function."</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="va">name</span> <span class="op">&lt;-</span> <span class="va">id</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span>        <span class="va">tax_hierarchy</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>                <span class="kw">if</span> <span class="op">(</span><span class="va">db</span> <span class="op">==</span> <span class="st">"ncbi"</span><span class="op">)</span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">taxize</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxize/reference/classification.html" class="external-link">classification</a></span><span class="op">(</span><span class="fu">taxize</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxize/reference/get_uid.html" class="external-link">get_uid</a></span><span class="op">(</span><span class="va">organism</span><span class="op">)</span>, db <span class="op">=</span> <span class="st">"ncbi"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>                <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">db</span> <span class="op">==</span> <span class="st">"itis"</span><span class="op">)</span>    </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">taxize</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxize/reference/classification.html" class="external-link">classification</a></span><span class="op">(</span><span class="fu">taxize</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxize/reference/get_tsn.html" class="external-link">get_tsn</a></span><span class="op">(</span><span class="va">organism</span><span class="op">)</span>, db <span class="op">=</span> <span class="st">"itis"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Could not retrieve taxonomy information from "</span>, <span class="va">db</span>, <span class="st">". Check internet connection or try again later."</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">tax_hierarchy</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        </span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">output</span> <span class="op">==</span> <span class="st">"classification"</span><span class="op">)</span><span class="op">{</span></span>
<span>                </span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">tax_hierarchy</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        </span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">output</span> <span class="op">==</span> <span class="st">"taxid"</span><span class="op">)</span><span class="op">{</span></span>
<span>                </span>
<span>                        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tax_hierarchy</span>, <span class="va">name</span> <span class="op">==</span> <span class="va">organism</span><span class="op">)</span>,<span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        </span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">output</span> <span class="op">==</span> <span class="st">"children"</span><span class="op">)</span><span class="op">{</span></span>
<span>                </span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">taxize</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxize/reference/children.html" class="external-link">children</a></span><span class="op">(</span><span class="va">organism</span>, db <span class="op">=</span> <span class="va">db</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span> </span>
<span><span class="op">}</span></span></code></pre></div>
</details><p>The <code>taxonomy()</code> function can be used to classify genomes
according to phylogenetic classification into Phylostrata
(Phylostratigraphy) or to retrieve species specific taxonomic
information when performing Divergence Stratigraphy.</p>
<p>For larger taxonomy queries it may be useful to create an NCBI
Account and set up an <a href="https://ncbiinsights.ncbi.nlm.nih.gov/2017/11/02/new-api-keys-for-the-e-utilities/" class="external-link">ENTREZ
API KEY</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages(c("taxize", "usethis"))</span></span>
<span><span class="fu">taxize</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxize/reference/key_helpers.html" class="external-link">use_entrez</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Create your key from your (brand-new) account's. </span></span>
<span><span class="co"># After generating your key set it as ENTREZ_KEY in .Renviron.</span></span>
<span><span class="co"># ENTREZ_KEY='youractualkeynotthisstring'</span></span>
<span><span class="co"># For that, use usethis::edit_r_environ()</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">edit_r_environ</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="taxonomic-information-retrieval">Taxonomic Information Retrieval<a class="anchor" aria-label="anchor" href="#taxonomic-information-retrieval"></a>
</h2>
<p>The <code>taxonomy()</code> function to retrieve taxonomic
information.</p>
<details><summary><strong>retrieve taxonomy hierarchy</strong>
</summary><p>In the following example we will obtain the taxonomic hierarchy of
<code>Arabidopsis thaliana</code> from <a href="https://www.ncbi.nlm.nih.gov/taxonomy" class="external-link">NCBI Taxonomy</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieving the taxonomic hierarchy of "Arabidopsis thaliana"</span></span>
<span><span class="co"># from NCBI Taxonomy</span></span>
<span><span class="fu">taxonomy</span><span class="op">(</span> organism <span class="op">=</span> <span class="st">"Arabidopsis thaliana"</span>, </span>
<span>          db       <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>          output   <span class="op">=</span> <span class="st">"classification"</span> <span class="op">)</span></span></code></pre></div>
<details><summary>
Show output
</summary><pre><code><span><span class="co">## <span style="color: #0000BB;">══</span>  1 queries  <span style="color: #0000BB;">═══════════════</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔  Found: </span> Arabidopsis+thaliana</span></span>
<span><span class="co">## <span style="color: #B2B2B2;">══</span>  Results  <span style="color: #B2B2B2;">═════════════════</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • Total: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Found: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Not Found: <span style="color: #00BB00;">0</span></span></span></code></pre>
<pre><code><span><span class="co">##                    name          rank      id</span></span>
<span><span class="co">## 1    cellular organisms cellular root  131567</span></span>
<span><span class="co">## 2             Eukaryota        domain    2759</span></span>
<span><span class="co">## 3         Viridiplantae       kingdom   33090</span></span>
<span><span class="co">## 4          Streptophyta        phylum   35493</span></span>
<span><span class="co">## 5        Streptophytina     subphylum  131221</span></span>
<span><span class="co">## 6           Embryophyta         clade    3193</span></span>
<span><span class="co">## 7          Tracheophyta         clade   58023</span></span>
<span><span class="co">## 8         Euphyllophyta         clade   78536</span></span>
<span><span class="co">## 9         Spermatophyta         clade   58024</span></span>
<span><span class="co">## 10        Magnoliopsida         class    3398</span></span>
<span><span class="co">## 11      Mesangiospermae         clade 1437183</span></span>
<span><span class="co">## 12       eudicotyledons         clade   71240</span></span>
<span><span class="co">## 13           Gunneridae         clade   91827</span></span>
<span><span class="co">## 14         Pentapetalae         clade 1437201</span></span>
<span><span class="co">## 15               rosids         clade   71275</span></span>
<span><span class="co">## 16              malvids         clade   91836</span></span>
<span><span class="co">## 17          Brassicales         order    3699</span></span>
<span><span class="co">## 18         Brassicaceae        family    3700</span></span>
<span><span class="co">## 19           Camelineae         tribe  980083</span></span>
<span><span class="co">## 20          Arabidopsis         genus    3701</span></span>
<span><span class="co">## 21 Arabidopsis thaliana       species    3702</span></span></code></pre>
</details><p>The <code>organism</code> argument takes the scientific name of a
query organism, the <code>db</code> argument specifies that database
from which the corresponding taxonomic information shall be retrieved,
e.g. <code>ncbi</code> (NCBI Taxonomy) and <code>itis</code> (Integrated
Taxonomic Information System) and the <code>output</code> argument
specifies the type of taxonomic information that shall be returned for
the query organism, e.g. <code>classification</code>,
<code>taxid</code>, or <code>children</code>.</p>
<p>The output of <code>classification</code> is a
<code>data.frame</code> storing the taxonomic hierarchy of
<code>Arabidopsis thaliana</code> starting with
<code>cellular organisms</code> up to <code>Arabidopsis thaliana</code>.
The first column stores the taxonomic name, the second column the
taxonomic rank, and the third column the NCBI Taxonomy id for
corresponding taxa.</p>
<p>Analogous <code>classification</code> information can be obtained
from different databases.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieving the taxonomic hierarchy of "Arabidopsis thaliana"</span></span>
<span><span class="co"># from the Integrated Taxonomic Information System</span></span>
<span><span class="fu">taxonomy</span><span class="op">(</span> organism <span class="op">=</span> <span class="st">"Arabidopsis thaliana"</span>, </span>
<span>          db       <span class="op">=</span> <span class="st">"itis"</span>,</span>
<span>          output   <span class="op">=</span> <span class="st">"classification"</span> <span class="op">)</span></span></code></pre></div>
<details><summary>
Show output
</summary><pre><code><span><span class="co">## <span style="color: #0000BB;">══</span>  1 queries  <span style="color: #0000BB;">═══════════════</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔  Found: </span> Arabidopsis thaliana</span></span>
<span><span class="co">## <span style="color: #B2B2B2;">══</span>  Results  <span style="color: #B2B2B2;">═════════════════</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • Total: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Found: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Not Found: <span style="color: #00BB00;">0</span></span></span></code></pre>
<pre><code><span><span class="co">##                    name          rank     id</span></span>
<span><span class="co">## 1               Plantae       kingdom 202422</span></span>
<span><span class="co">## 2         Viridiplantae    subkingdom 954898</span></span>
<span><span class="co">## 3          Streptophyta  infrakingdom 846494</span></span>
<span><span class="co">## 4           Embryophyta superdivision 954900</span></span>
<span><span class="co">## 5          Tracheophyta      division 846496</span></span>
<span><span class="co">## 6       Spermatophytina   subdivision 846504</span></span>
<span><span class="co">## 7         Magnoliopsida         class  18063</span></span>
<span><span class="co">## 8               Rosanae    superorder 846548</span></span>
<span><span class="co">## 9           Brassicales         order 822943</span></span>
<span><span class="co">## 10         Brassicaceae        family  22669</span></span>
<span><span class="co">## 11          Arabidopsis         genus  23040</span></span>
<span><span class="co">## 12 Arabidopsis thaliana       species  23041</span></span></code></pre>
<p>The <code>output</code> argument allows you to directly access
taxonomy ids for a query organism or species.</p>
</details></details><details><summary><strong>retrieve taxonomy ID from <code>ncbi</code></strong>
</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieving the taxonomy id of the query organism from NCBI Taxonomy</span></span>
<span><span class="fu">taxonomy</span><span class="op">(</span> organism <span class="op">=</span> <span class="st">"Arabidopsis thaliana"</span>, </span>
<span>          db       <span class="op">=</span> <span class="st">"ncbi"</span>, </span>
<span>          output   <span class="op">=</span> <span class="st">"taxid"</span> <span class="op">)</span></span></code></pre></div>
<details><summary>
Show output
</summary><pre><code><span><span class="co">## <span style="color: #0000BB;">══</span>  1 queries  <span style="color: #0000BB;">═══════════════</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔  Found: </span> Arabidopsis+thaliana</span></span>
<span><span class="co">## <span style="color: #B2B2B2;">══</span>  Results  <span style="color: #B2B2B2;">═════════════════</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • Total: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Found: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Not Found: <span style="color: #00BB00;">0</span></span></span></code></pre>
<pre><code><span><span class="co">##     id</span></span>
<span><span class="co">## 1 3702</span></span></code></pre>
</details></details><details><summary><strong>retrieve taxonomy ID from <code>itis</code></strong>
</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieving the taxonomy id of the query organism from Integrated Taxonomic Information Service</span></span>
<span><span class="fu">taxonomy</span><span class="op">(</span> organism <span class="op">=</span> <span class="st">"Arabidopsis"</span>, </span>
<span>          db       <span class="op">=</span> <span class="st">"itis"</span>, </span>
<span>          output   <span class="op">=</span> <span class="st">"taxid"</span> <span class="op">)</span></span></code></pre></div>
<details><summary>
Show output
</summary><pre><code><span><span class="co">## <span style="color: #0000BB;">══</span>  1 queries  <span style="color: #0000BB;">═══════════════</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔  Found: </span> Arabidopsis</span></span>
<span><span class="co">## <span style="color: #B2B2B2;">══</span>  Results  <span style="color: #B2B2B2;">═════════════════</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • Total: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Found: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Not Found: <span style="color: #00BB00;">0</span></span></span></code></pre>
<pre><code><span><span class="co">##      id</span></span>
<span><span class="co">## 1 23040</span></span></code></pre>
</details></details><p>So far, the following data bases can be accesses to retrieve
taxonomic information:</p>
<ul>
<li>
<code>db = "itis"</code> : Integrated Taxonomic Information
Service</li>
<li>
<code>db = "ncbi"</code> : National Center for Biotechnology
Information</li>
</ul>
<details><summary><strong>How does the <code>taxonomy(db = "ncbi")</code> output differ
from <code>GenEra</code>?</strong>
</summary><p>The taxonomic classifications should be the same between
<code>taxonomy(..., db = "ncbi")</code> and the taxonomic
classifications in the <code>GenEra</code> output (since it uses NCBI
taxdump as input). But it should be noted that the recent updates to
NCBI taxonomy has meant that the highest order ranks (cellular root,
domain, kingdom etc.) may differ.</p>
</details>
</div>
<div class="section level2">
<h2 id="retrieve-children-nodes">Retrieve Children Nodes<a class="anchor" aria-label="anchor" href="#retrieve-children-nodes"></a>
</h2>
<p>Another <code>output</code> supported by <code>taxonomy()</code> is
<code>children</code> that returns the immediate children taxa for a
query organism. This feature is useful to determine species
relationships for quantifying recent evolutionary conservation with
Divergence Stratigraphy.</p>
<details><summary><strong>retrieve children nodes from <code>ncbi</code></strong>
</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieve children taxa of the query organism stored in the correspondning database</span></span>
<span><span class="fu">taxonomy</span><span class="op">(</span> organism <span class="op">=</span> <span class="st">"Arabidopsis"</span>, </span>
<span>          db       <span class="op">=</span> <span class="st">"ncbi"</span>, </span>
<span>          output   <span class="op">=</span> <span class="st">"children"</span> <span class="op">)</span></span></code></pre></div>
<details><summary>
Show output
</summary><pre><code><span><span class="co">## <span style="color: #0000BB;">══</span>  1 queries  <span style="color: #0000BB;">═══════════════</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔  Found: </span> Arabidopsis</span></span>
<span><span class="co">## <span style="color: #B2B2B2;">══</span>  Results  <span style="color: #B2B2B2;">═════════════════</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • Total: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Found: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Not Found: <span style="color: #00BB00;">0</span></span></span></code></pre>
<pre><code><span><span class="co">##    childtaxa_id</span></span>
<span><span class="co">## 1       2608267</span></span>
<span><span class="co">## 2       2486701</span></span>
<span><span class="co">## 3       1837063</span></span>
<span><span class="co">## 4       1547872</span></span>
<span><span class="co">## 5       1328956</span></span>
<span><span class="co">## 6       1240361</span></span>
<span><span class="co">## 7        869751</span></span>
<span><span class="co">## 8        869750</span></span>
<span><span class="co">## 9        864766</span></span>
<span><span class="co">## 10       412662</span></span>
<span><span class="co">## 11       378006</span></span>
<span><span class="co">## 12       347883</span></span>
<span><span class="co">## 13       302551</span></span>
<span><span class="co">## 14        97980</span></span>
<span><span class="co">## 15        97979</span></span>
<span><span class="co">## 16        81970</span></span>
<span><span class="co">## 17        59690</span></span>
<span><span class="co">## 18        59689</span></span>
<span><span class="co">## 19        45251</span></span>
<span><span class="co">## 20        45249</span></span>
<span><span class="co">## 21        38785</span></span>
<span><span class="co">## 22         3702</span></span>
<span><span class="co">##                                                        childtaxa_name</span></span>
<span><span class="co">## 1                            Arabidopsis arenosa x Arabidopsis lyrata</span></span>
<span><span class="co">## 2                            Arabidopsis lyrata x Arabidopsis halleri</span></span>
<span><span class="co">## 3                          Arabidopsis thaliana x Arabidopsis halleri</span></span>
<span><span class="co">## 4                                               Arabidopsis umezawana</span></span>
<span><span class="co">## 5  (Arabidopsis thaliana x Arabidopsis arenosa) x Arabidopsis suecica</span></span>
<span><span class="co">## 6                          Arabidopsis thaliana x Arabidopsis arenosa</span></span>
<span><span class="co">## 7         Arabidopsis thaliana x Arabidopsis halleri subsp. gemmifera</span></span>
<span><span class="co">## 8                           Arabidopsis thaliana x Arabidopsis lyrata</span></span>
<span><span class="co">## 9                                         Arabidopsis septentrionalis</span></span>
<span><span class="co">## 10                                            Arabidopsis pedemontana</span></span>
<span><span class="co">## 11                         Arabidopsis arenosa x Arabidopsis thaliana</span></span>
<span><span class="co">## 12                                              Arabidopsis arenicola</span></span>
<span><span class="co">## 13                                              Arabidopsis petrogena</span></span>
<span><span class="co">## 14                                               Arabidopsis croatica</span></span>
<span><span class="co">## 15                                            Arabidopsis cebennensis</span></span>
<span><span class="co">## 16                                                Arabidopsis halleri</span></span>
<span><span class="co">## 17                                             Arabidopsis kamchatica</span></span>
<span><span class="co">## 18                                                 Arabidopsis lyrata</span></span>
<span><span class="co">## 19                                               Arabidopsis neglecta</span></span>
<span><span class="co">## 20                                                Arabidopsis suecica</span></span>
<span><span class="co">## 21                                                Arabidopsis arenosa</span></span>
<span><span class="co">## 22                                               Arabidopsis thaliana</span></span>
<span><span class="co">##    childtaxa_rank</span></span>
<span><span class="co">## 1         species</span></span>
<span><span class="co">## 2         species</span></span>
<span><span class="co">## 3         species</span></span>
<span><span class="co">## 4         species</span></span>
<span><span class="co">## 5         species</span></span>
<span><span class="co">## 6         species</span></span>
<span><span class="co">## 7         species</span></span>
<span><span class="co">## 8         species</span></span>
<span><span class="co">## 9         species</span></span>
<span><span class="co">## 10        species</span></span>
<span><span class="co">## 11        species</span></span>
<span><span class="co">## 12        species</span></span>
<span><span class="co">## 13        species</span></span>
<span><span class="co">## 14        species</span></span>
<span><span class="co">## 15        species</span></span>
<span><span class="co">## 16        species</span></span>
<span><span class="co">## 17        species</span></span>
<span><span class="co">## 18        species</span></span>
<span><span class="co">## 19        species</span></span>
<span><span class="co">## 20        species</span></span>
<span><span class="co">## 21        species</span></span>
<span><span class="co">## 22        species</span></span></code></pre>
</details></details><details><summary><strong>retrieve children nodes from <code>itis</code></strong>
</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieve children taxa of the query organism stored in the correspondning database</span></span>
<span><span class="fu">taxonomy</span><span class="op">(</span> organism <span class="op">=</span> <span class="st">"Arabidopsis"</span>, </span>
<span>          db       <span class="op">=</span> <span class="st">"itis"</span>, </span>
<span>          output   <span class="op">=</span> <span class="st">"children"</span> <span class="op">)</span></span></code></pre></div>
<details><summary>
Show output
</summary><pre><code><span><span class="co">## <span style="color: #0000BB;">══</span>  1 queries  <span style="color: #0000BB;">═══════════════</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔  Found: </span> Arabidopsis</span></span>
<span><span class="co">## <span style="color: #B2B2B2;">══</span>  Results  <span style="color: #B2B2B2;">═════════════════</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • Total: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Found: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Not Found: <span style="color: #00BB00;">0</span></span></span>
<span><span class="co">## <span style="color: #0000BB;">══</span>  1 queries  <span style="color: #0000BB;">═══════════════</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔  Found: </span> Arabidopsis</span></span>
<span><span class="co">## <span style="color: #B2B2B2;">══</span>  Results  <span style="color: #B2B2B2;">═════════════════</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • Total: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Found: <span style="color: #00BB00;">1</span> </span></span>
<span><span class="co">## • Not Found: <span style="color: #00BB00;">0</span></span></span></code></pre>
<pre><code><span><span class="co">##    parentname parenttsn rankname             taxonname    tsn</span></span>
<span><span class="co">## 1 Arabidopsis     23040  Species  Arabidopsis thaliana  23041</span></span>
<span><span class="co">## 2 Arabidopsis     23040  Species Arabidopsis arenicola 823113</span></span>
<span><span class="co">## 3 Arabidopsis     23040  Species   Arabidopsis arenosa 823130</span></span>
<span><span class="co">## 4 Arabidopsis     23040  Species    Arabidopsis lyrata 823171</span></span></code></pre>
</details></details><p>These results allow us to choose <code>subject</code> organisms for
<a href="other-strata.html">Divergence Stratigraphy</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hajk-Georg Drost, Stefan Manolache, Jaruwatana Sodai Lotharukpong, Nikola Kalábová, Filipa Martins Costa, Kristian K Ullrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
