<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Age Category Specific apply Function — age.apply • myTAI</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Age Category Specific apply Function — age.apply" />

<meta property="og:description" content="This function performs the split-apply-combine methodology on Phylostrata or Divergence Strata stored within the input ExpressionSet.
This function is very useful to perform any phylostratum or divergence-stratum specific analysis." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">myTAI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Advanced.html">Advanced Phylotranscriptomics Analyses</a>
    </li>
    <li>
      <a href="../articles/Enrichment.html">Enrichment Analyses</a>
    </li>
    <li>
      <a href="../articles/Expression.html">Gene Expression Analysis with `myTAI`</a>
    </li>
    <li>
      <a href="../articles/Intermediate.html">Intermediate Phylotranscriptomics Analyses</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to the myTAI Package</a>
    </li>
    <li>
      <a href="../articles/Taxonomy.html">Retrieving Taxonomic Information</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/HajkD/myTAI">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Age Category Specific apply Function</h1>
    <small class="dont-index">Source: <a href='https://github.com/HajkD/myTAI/blob/master/R/age.apply.R'><code>R/age.apply.R</code></a></small>
    <div class="hidden name"><code>age.apply.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function performs the split-apply-combine methodology on Phylostrata or Divergence Strata stored within the input ExpressionSet.</p>
<p>This function is very useful to perform any phylostratum or divergence-stratum specific analysis.</p>
    
    </div>

    <pre class="usage"><span class='fu'>age.apply</span>(<span class='no'>ExpressionSet</span>, <span class='no'>FUN</span>, <span class='no'>...</span>, <span class='kw'>as.list</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ExpressionSet</th>
      <td><p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>a function to be performed on the corresponding expression matrix of each phylostratum or divergence-stratum.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments of FUN.</p></td>
    </tr>
    <tr>
      <th>as.list</th>
      <td><p>a boolean value specifying whether the output format shall be a matrix or a list object.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Either a numeric matrix storing the return values of the applied function for each age class
or a numeric list storing the return values of the applied function for each age class in a list.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function uses the <code><a href='https://www.rdocumentation.org/packages/base/topics/split'>split</a></code> function to subset the expression matrix into
phylostratum specific sub-matrices. Internally using <code><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></code>, any function can
be performed to the sub-matrices. The return value of this function is a numeric matrix storing
the return values by <code>FUN</code> for each phylostratum and each developmental stage s. 
Note that the input <code>FUN</code> must be an function that can be applied to a matrix (e.g., <code><a href='https://www.rdocumentation.org/packages/base/topics/colSums'>colMeans</a></code> or <code><a href='RE.html'>RE</a></code>). 
In case you use an an anymous function you coud use <code>function(x) apply(x , 2 , var)</code> as an example to compute the variance of each phylostratum and each
developmental stage s.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/base/topics/split'>split</a></code>, <code><a href='https://www.rdocumentation.org/packages/base/topics/tapply'>tapply</a></code>, <code><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></code>, <code><a href='RE.html'>RE</a></code>, <code><a href='REMatrix.html'>REMatrix</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
 <span class='co'># source the example dataset</span>
 <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>PhyloExpressionSetExample</span>)

<span class='co'># Example 1</span>
<span class='co'># get the relative expression profiles for each phylostratum</span>
<span class='fu'>age.apply</span>(<span class='no'>PhyloExpressionSetExample</span>, <span class='no'>RE</span>)</div><div class='output co'>#&gt;       Zygote  Quadrant   Globular      Heart    Torpedo       Bent    Mature
#&gt; 1  0.4816246 0.3145330 0.46389184 0.00000000 0.17067495 0.56880234 1.0000000
#&gt; 2  1.0000000 0.9363209 0.63348381 0.40823711 0.14904726 0.00000000 0.2206063
#&gt; 3  0.6083424 0.4109402 0.00000000 0.09521758 0.16284114 0.21213845 1.0000000
#&gt; 4  0.2985050 0.2366309 0.04946941 0.07499453 0.00000000 0.20573325 1.0000000
#&gt; 5  0.2893657 0.2799777 0.00000000 0.01401191 0.01365328 0.45908792 1.0000000
#&gt; 6  0.2323316 0.2786335 0.02706119 0.00000000 0.03592044 0.20084761 1.0000000
#&gt; 7  0.5666979 0.2620602 0.00000000 0.12099252 0.07133814 0.13232551 1.0000000
#&gt; 8  0.4203039 0.3092784 0.09237036 0.05442042 0.00000000 0.45520558 1.0000000
#&gt; 9  0.4586261 0.4668613 0.39738003 0.23205534 0.00000000 0.37067096 1.0000000
#&gt; 10 0.8811321 1.0000000 0.53841500 0.22974016 0.00000000 0.30490542 0.4881046
#&gt; 11 0.4015809 0.4877111 0.04846721 0.05741594 0.00000000 0.07716367 1.0000000
#&gt; 12 0.5052572 0.3359211 0.07100055 0.09489782 0.00000000 0.25811214 1.0000000</div><div class='input'>
<span class='co'># this is analogous to </span>
<span class='fu'><a href='REMatrix.html'>REMatrix</a></span>(<span class='no'>PhyloExpressionSetExample</span>)</div><div class='output co'>#&gt;       Zygote  Quadrant   Globular      Heart    Torpedo       Bent    Mature
#&gt; 1  0.4816246 0.3145330 0.46389184 0.00000000 0.17067495 0.56880234 1.0000000
#&gt; 2  1.0000000 0.9363209 0.63348381 0.40823711 0.14904726 0.00000000 0.2206063
#&gt; 3  0.6083424 0.4109402 0.00000000 0.09521758 0.16284114 0.21213845 1.0000000
#&gt; 4  0.2985050 0.2366309 0.04946941 0.07499453 0.00000000 0.20573325 1.0000000
#&gt; 5  0.2893657 0.2799777 0.00000000 0.01401191 0.01365328 0.45908792 1.0000000
#&gt; 6  0.2323316 0.2786335 0.02706119 0.00000000 0.03592044 0.20084761 1.0000000
#&gt; 7  0.5666979 0.2620602 0.00000000 0.12099252 0.07133814 0.13232551 1.0000000
#&gt; 8  0.4203039 0.3092784 0.09237036 0.05442042 0.00000000 0.45520558 1.0000000
#&gt; 9  0.4586261 0.4668613 0.39738003 0.23205534 0.00000000 0.37067096 1.0000000
#&gt; 10 0.8811321 1.0000000 0.53841500 0.22974016 0.00000000 0.30490542 0.4881046
#&gt; 11 0.4015809 0.4877111 0.04846721 0.05741594 0.00000000 0.07716367 1.0000000
#&gt; 12 0.5052572 0.3359211 0.07100055 0.09489782 0.00000000 0.25811214 1.0000000</div><div class='input'><span class='co'># Example 2</span>
<span class='co'># compute the mean expression profiles for each phylostratum</span>
<span class='fu'>age.apply</span>(<span class='no'>PhyloExpressionSetExample</span>, <span class='no'>colMeans</span>)</div><div class='output co'>#&gt;      Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature
#&gt; 1  2607.882 2579.372 2604.856 2525.704 2554.825 2622.757 2696.331
#&gt; 2  2597.258 2574.745 2467.679 2388.045 2296.410 2243.716 2321.709
#&gt; 3  2528.272 2363.159 2019.436 2099.079 2155.642 2196.875 2855.866
#&gt; 4  1925.320 1887.078 1771.399 1787.175 1740.823 1867.981 2358.893
#&gt; 5  2378.883 2368.593 2061.729 2077.087 2076.693 2564.904 3157.761
#&gt; 6  1658.253 1697.242 1485.401 1462.613 1492.861 1631.741 2304.683
#&gt; 7  1993.321 1717.659 1480.525 1590.009 1545.078 1600.264 2385.409
#&gt; 8  1781.653 1670.106 1452.180 1414.052 1359.376 1816.718 2364.070
#&gt; 9  1758.119 1764.748 1708.815 1575.727 1388.920 1687.314 2193.930
#&gt; 10 2414.456 2501.390 2163.810 1938.060 1770.039 1993.032 2127.015
#&gt; 11 1999.163 2071.456 1702.779 1710.290 1662.099 1726.865 2501.443
#&gt; 12 2126.189 2036.804 1896.964 1909.578 1859.485 1995.732 2387.343</div><div class='input'>
<span class='co'># Example 3</span>
<span class='co'># compute the variance profiles for each phylostratum</span>
<span class='fu'>age.apply</span>(<span class='no'>PhyloExpressionSetExample</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>(<span class='no'>x</span> , <span class='fl'>2</span> , <span class='no'>var</span>))</div><div class='output co'>#&gt;      Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature
#&gt; 1  46858320 44033012 44106145 38877224 37548528 39453762 48129006
#&gt; 2  46867279 42686867 36090002 32587501 29232620 28376678 30460806
#&gt; 3  41783430 37194145 17928194 20312145 21038520 24918360 57471592
#&gt; 4  19261723 17160926 13850827 14557261 13350847 19932521 42637133
#&gt; 5  32592884 31153055 21527988 22233611 23096264 45694558 78388518
#&gt; 6  12118906 13540947  8706851  8870013 10758437 17580299 58334320
#&gt; 7  30355579 18174987  7117039 10899294 12633952 15875758 55103241
#&gt; 8  13397069 11015110  6730029  5014969  3743414 27906852 52729250
#&gt; 9  11342446 12741601 14947365  8479977  4709920 22850095 41873875
#&gt; 10 47788107 50703428 35831030 30053404 22091444 35323704 36885550
#&gt; 11 24104869 30970830 12777528 14043089 16961809 24200949 56830372
#&gt; 12 30642509 27840568 23658038 23072584 22502870 29014330 49513851</div><div class='input'>
<span class='co'># Example 4</span>
<span class='co'># compute the range for each phylostratum</span>
<span class='co'># Note: in this case, the range() function returns 2 values for each phylostratum</span>
<span class='co'># and each developmental stage, hence one should use the argument 'as.list = TRUE'</span>
<span class='co'># to make sure that the results are returned properly </span>
<span class='fu'>age.apply</span>(<span class='no'>PhyloExpressionSetExample</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>(<span class='no'>x</span> , <span class='fl'>2</span> , <span class='no'>range</span>), <span class='kw'>as.list</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; $`1`
#&gt;         Zygote   Quadrant   Globular      Heart    Torpedo       Bent
#&gt; [1,]   585.206   554.8961   548.0507   568.1412   540.0542   535.9804
#&gt; [2,] 71936.292 68151.2904 72995.7957 67833.2550 64942.5576 69482.5093
#&gt;          Mature
#&gt; [1,]   532.3402
#&gt; [2,] 77475.7206
#&gt; 
#&gt; $`2`
#&gt;          Zygote   Quadrant   Globular      Heart    Torpedo       Bent
#&gt; [1,]   580.6445   574.6997   560.7247   547.7568   557.0626   530.3735
#&gt; [2,] 73999.5109 66168.5626 68717.7230 64428.0043 64437.4151 68692.2235
#&gt;          Mature
#&gt; [1,]   562.4309
#&gt; [2,] 67137.1151
#&gt; 
#&gt; $`3`
#&gt;          Zygote   Quadrant   Globular      Heart    Torpedo       Bent
#&gt; [1,]   623.1659   589.5403   580.2586   588.6726   566.7765   558.5507
#&gt; [2,] 68451.1737 67297.4233 60605.4226 61712.1844 54853.5566 55114.0385
#&gt;          Mature
#&gt; [1,]   596.9872
#&gt; [2,] 67058.7800
#&gt; 
#&gt; $`4`
#&gt;          Zygote   Quadrant   Globular      Heart    Torpedo       Bent
#&gt; [1,]   589.5377   574.8131   560.7161   559.2638   569.3281   553.8426
#&gt; [2,] 64147.2534 63952.2243 57847.7659 61816.6287 48750.3696 60011.1444
#&gt;          Mature
#&gt; [1,]   572.2069
#&gt; [2,] 75420.3483
#&gt; 
#&gt; $`5`
#&gt;         Zygote   Quadrant   Globular      Heart    Torpedo       Bent    Mature
#&gt; [1,]   571.478   572.2143   597.7567   588.9979   567.5319   571.7144   564.607
#&gt; [2,] 66824.532 55393.2659 54161.7005 56953.2335 56346.4812 61459.7431 81105.580
#&gt; 
#&gt; $`6`
#&gt;          Zygote   Quadrant  Globular      Heart   Torpedo      Bent     Mature
#&gt; [1,]   589.0266   576.3678   568.514   575.5234   567.864   554.431   569.6375
#&gt; [2,] 61492.5176 58588.9023 54426.657 53748.3906 57102.640 61177.576 81496.1486
#&gt; 
#&gt; $`7`
#&gt;          Zygote   Quadrant   Globular     Heart    Torpedo       Bent
#&gt; [1,]   605.8876   581.1317   592.6554   591.897   560.0847   563.6024
#&gt; [2,] 62256.6328 56018.9987 25729.4257 34192.828 44443.2861 50930.9745
#&gt;          Mature
#&gt; [1,]   561.2506
#&gt; [2,] 71635.6409
#&gt; 
#&gt; $`8`
#&gt;          Zygote   Quadrant   Globular      Heart    Torpedo       Bent
#&gt; [1,]   637.9878   569.1286   584.7325   605.0823   594.4442   600.2223
#&gt; [2,] 41138.0802 40931.4758 33941.3019 29157.0095 23359.8204 68783.3661
#&gt;          Mature
#&gt; [1,]   556.4985
#&gt; [2,] 68490.5460
#&gt; 
#&gt; $`9`
#&gt;          Zygote   Quadrant   Globular      Heart  Torpedo       Bent     Mature
#&gt; [1,]   641.0205   616.7897   581.1254   581.5667   586.88   591.8835   579.5047
#&gt; [2,] 33543.3348 34506.4575 48067.4038 31816.1675 21583.04 65310.1500 67092.0569
#&gt; 
#&gt; $`10`
#&gt;          Zygote   Quadrant   Globular      Heart   Torpedo       Bent
#&gt; [1,]   615.9278   592.7529   574.7775   575.9234   572.552   578.3298
#&gt; [2,] 66638.5047 62675.8417 67192.4804 64719.1091 60300.004 66748.8375
#&gt;          Mature
#&gt; [1,]   582.9723
#&gt; [2,] 67226.2424
#&gt; 
#&gt; $`11`
#&gt;          Zygote   Quadrant   Globular      Heart    Torpedo       Bent
#&gt; [1,]   619.2366   592.5207   597.7823   591.3239   566.7128   583.1649
#&gt; [2,] 47624.9229 57584.7661 35765.6619 28663.2997 40557.9861 56151.2591
#&gt;          Mature
#&gt; [1,]   607.0129
#&gt; [2,] 59611.1041
#&gt; 
#&gt; $`12`
#&gt;          Zygote   Quadrant   Globular      Heart    Torpedo       Bent
#&gt; [1,]   604.2214   569.8133   554.2327   569.9091   543.0326   532.1237
#&gt; [2,] 65504.4362 64548.6717 68522.0261 65165.0830 59914.2792 64947.7257
#&gt;          Mature
#&gt; [1,]   563.0654
#&gt; [2,] 68435.7395
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Hajk-Georg Drost</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Hajk-Georg Drost.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

