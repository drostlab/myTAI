<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Gene Expression Heatmap — plot_gene_heatmap • myTAI</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot Gene Expression Heatmap — plot_gene_heatmap"><meta name="description" content="Create a heatmap showing gene expression patterns across conditions
with optional dendrograms and gene age annotation."><meta property="og:description" content="Create a heatmap showing gene expression patterns across conditions
with optional dendrograms and gene age annotation."><meta property="og:image" content="https://drostlab.github.io/myTAI/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">myTAI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/myTAI.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/phylo-expression-object.html">Bring your datasets into myTAI</a></li>
    <li><a class="dropdown-item" href="../articles/tai-stats.html">Statistical testing with myTAI</a></li>
    <li><a class="dropdown-item" href="../articles/tai-transform.html">Transforming dataset for myTAI</a></li>
    <li><a class="dropdown-item" href="../articles/tai-breaker.html">Break TAI patterns using gaTAI</a></li>
    <li><a class="dropdown-item" href="../articles/tai-gallery.html">Beautiful plots made via myTAI</a></li>
    <li><a class="dropdown-item" href="../articles/index.html">... and view more!</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/drostlab/myTAI/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot Gene Expression Heatmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/drostlab/myTAI/blob/HEAD/R/plot_gene_heatmap.R" class="external-link"><code>R/plot_gene_heatmap.R</code></a></small>
      <div class="d-none name"><code>plot_gene_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a heatmap showing gene expression patterns across conditions
with optional dendrograms and gene age annotation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_gene_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">phyex_set</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  std <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_reps <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_cols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  order_by_stage <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_gene_age <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_gene_ids <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gene_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gene_annotation_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phyex-set">phyex_set<a class="anchor" aria-label="anchor" href="#arg-phyex-set"></a></dt>
<dd><p>A PhyloExpressionSet object (BulkPhyloExpressionSet or ScPhyloExpressionSet)</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character vector of specific gene IDs to include in the heatmap (default: NULL for auto-selection of dynamic genes)</p></dd>


<dt id="arg-top-p">top_p<a class="anchor" aria-label="anchor" href="#arg-top-p"></a></dt>
<dd><p>Numeric value specifying the top proportion of genes to include (default: NULL). Ignored if top_k is specified.</p></dd>


<dt id="arg-top-k">top_k<a class="anchor" aria-label="anchor" href="#arg-top-k"></a></dt>
<dd><p>Absolute number of top genes to select (default: 30). Takes precedence over top_p.</p></dd>


<dt id="arg-std">std<a class="anchor" aria-label="anchor" href="#arg-std"></a></dt>
<dd><p>Logical indicating whether to standardize expression values (default: TRUE)</p></dd>


<dt id="arg-show-reps">show_reps<a class="anchor" aria-label="anchor" href="#arg-show-reps"></a></dt>
<dd><p>Logical indicating whether to show replicates or collapsed data (default: FALSE)</p></dd>


<dt id="arg-cluster-rows">cluster_rows<a class="anchor" aria-label="anchor" href="#arg-cluster-rows"></a></dt>
<dd><p>Logical indicating whether to cluster genes/rows (default: FALSE)</p></dd>


<dt id="arg-cluster-cols">cluster_cols<a class="anchor" aria-label="anchor" href="#arg-cluster-cols"></a></dt>
<dd><p>Logical indicating whether to cluster conditions/columns (default: FALSE)</p></dd>


<dt id="arg-order-by-stage">order_by_stage<a class="anchor" aria-label="anchor" href="#arg-order-by-stage"></a></dt>
<dd><p>Logical indicating whether to order genes by expression angle/developmental stage (default: TRUE). Ignored if cluster_rows is TRUE</p></dd>


<dt id="arg-show-gene-age">show_gene_age<a class="anchor" aria-label="anchor" href="#arg-show-gene-age"></a></dt>
<dd><p>Logical indicating whether to show gene age annotation (default: TRUE)</p></dd>


<dt id="arg-show-gene-ids">show_gene_ids<a class="anchor" aria-label="anchor" href="#arg-show-gene-ids"></a></dt>
<dd><p>Logical indicating whether to show gene identifiers (default: FALSE)</p></dd>


<dt id="arg-gene-annotation">gene_annotation<a class="anchor" aria-label="anchor" href="#arg-gene-annotation"></a></dt>
<dd><p>Data frame with custom gene annotations, rownames should match gene IDs (default: NULL)</p></dd>


<dt id="arg-gene-annotation-colors">gene_annotation_colors<a class="anchor" aria-label="anchor" href="#arg-gene-annotation-colors"></a></dt>
<dd><p>Named list of color vectors for custom gene annotations (default: NULL)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to specific methods</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object (converted from pheatmap) showing the gene expression heatmap</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function creates a comprehensive heatmap visualization of gene expression patterns.
By default, genes are ordered by their expression angle (developmental trajectory).
The function supports clustering of both genes and identities, and can optionally
display gene age (phylostratum) as a colored annotation bar.</p>
<p>For bulk data, the heatmap shows expression across developmental conditions.
For single-cell data, the heatmap shows expression across cell types.</p>
<p>The gene age annotation uses the PS_colours function to create a consistent
color scheme across different myTAI visualizations.</p>
<p>Custom gene annotations can be provided via the <code>gene_annotation</code> parameter,
which should be a data frame with gene IDs as rownames and annotation categories
as columns. Corresponding colors should be provided via <code>gene_annotation_colors</code>
as a named list where names match the annotation column names.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic heatmap with gene age annotation</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">plot_gene_heatmap</span><span class="op">(</span><span class="va">example_phyex_set</span>, show_gene_age <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single-cell heatmap with subset of cells</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">plot_gene_heatmap</span><span class="op">(</span><span class="va">example_phyex_set_sc</span>, show_reps <span class="op">=</span> <span class="cn">TRUE</span>, max_cells_per_type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Showing 9 out of 200 cells. Use max_cells_per_type to control the number of cells per type.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Custom gene annotation example</span></span></span>
<span class="r-in"><span><span class="va">gene_ids</span> <span class="op">&lt;-</span> <span class="va">example_phyex_set</span><span class="op">@</span><span class="va">gene_ids</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">gene_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High"</span>, <span class="st">"Medium"</span>, <span class="st">"Low"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  row.names <span class="op">=</span> <span class="va">gene_ids</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"Medium"</span> <span class="op">=</span> <span class="st">"yellow"</span>, <span class="st">"Low"</span> <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">plot_gene_heatmap</span><span class="op">(</span><span class="va">example_phyex_set</span> <span class="op">|&gt;</span> <span class="fu"><a href="select_genes.html">select_genes</a></span><span class="op">(</span><span class="va">gene_ids</span><span class="op">)</span>, gene_annotation <span class="op">=</span> <span class="va">gene_annot</span>, </span></span>
<span class="r-in"><span>                       gene_annotation_colors <span class="op">=</span> <span class="va">colors</span>, show_gene_age <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hajk-Georg Drost, Stefan Manolache, Jaruwatana Sodai Lotharukpong, Nikola Kalábová, Filipa Martins Costa, Kristian K Ullrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

